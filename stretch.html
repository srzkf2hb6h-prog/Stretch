<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">

<!-- –ë–ª–æ–∫–∏—Ä—É–µ–º –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ iPhone -->
<meta name="viewport"
      content="width=device-width, initial-scale=1.0,
               maximum-scale=1.0, user-scalable=no">

<title>–†–∞—Å—Ç—è–∂–∫–∞ ‚Äî 8 –º–∏–Ω—É—Ç</title>

<style>
/* –ë–µ–∑ –ø—Ä–æ–∫—Ä—É—Ç–∫–∏ */
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    overflow: hidden;
}

body {
    font-family: system-ui, -apple-system, sans-serif;
    background: #1c1c1e;
    color: #f2f2f2;
    display: flex;
    flex-direction: column;
}

/* –ó–∞–≥–æ–ª–æ–≤–æ–∫ */
#header {
    background: #ffffff;
    color: #000000;
    padding: 10px 18px;
    margin: 12px auto 2px auto;
    border-radius: 12px;
    width: fit-content;
}

#header h1 {
    margin: 0;
    font-size: 18px;
    font-weight: 700;
    text-transform: uppercase;
}

/* –¶–µ–Ω—Ç—Ä */
#center-area {
    flex: 1;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    text-align: center;
}

#exercise-index {
    font-size: 14px;
    color: #aaa;
    height: 18px;
    margin-bottom: 6px;
}

/* –ü—Ä–æ–≥—Ä–µ—Å—Å-—Ç–æ—á–∫–∏ */
#progress-dots {
    font-size: 22px;
    letter-spacing: 4px;
    margin-bottom: 12px;
}

#exercise {
    font-size: 26px;
    font-weight: 600;
    margin-bottom: 6px;
}

#emoji-box {
    font-size: 52px;
    margin-bottom: 10px;
}

/* –¢–∞–π–º–µ—Ä */
.timer-circle {
    width: 200px;
    height: 200px;
    position: relative;
    margin-bottom: 10px;
}

svg.timer-svg {
    transform: rotate(-90deg);
}

#progress-ring {
    stroke: #4CAF50;
    stroke-width: 12;
    fill: transparent;
    transition: stroke-dashoffset 1s linear;
}

#background-ring {
    stroke: #444;
    stroke-width: 12;
    fill: transparent;
}

#timer {
    position: absolute;
    top: 76px;
    left: 0;
    width: 100%;
    font-size: 32px;
    font-weight: bold;
}

/* –û–±—â–∏–π —Ç–∞–π–º–µ—Ä */
#total-time {
    font-size: 15px;
    color: #bbb;
    margin-top: 4px;
}

/* –ö–Ω–æ–ø–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è */
#restart-btn {
    margin-top: 18px;
    padding: 14px 28px;
    font-size: 18px;
    background: #4CAF50;
    color: #fff;
    border-radius: 10px;
    border: none;
}

/* –ù–∏–∑ —ç–∫—Ä–∞–Ω–∞ */
#controls-wrapper {
    padding-top: 10px;
    padding-bottom: 40px;
    display: flex;
    align-items: center;
    justify-content: space-between;
}

.side-space {
    width: 54px;
    display: flex;
    justify-content: center;
}

#controls-center {
    display: flex;
    gap: 10px;
}

button {
    padding: 10px 18px;
    background: #4CAF50;
    border: none;
    border-radius: 8px;
    color: white;
    font-size: 17px;
}

#pause-btn { background: #FF9800; }
#cancel-btn { background: #B00020; }

.arrow-btn {
    background: #3a3a3c;
    min-width: 48px;
}

/* –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ */
.hidden { display: none; }
.invisible { visibility: hidden; }

</style>

<!-- –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ double-tap zoom -->
<script>
document.addEventListener('touchstart', function(e) {
    if (e.touches.length > 1) e.preventDefault();
}, { passive: false });

let lastTouch = 0;
document.addEventListener('touchend', function(e) {
    const now = Date.now();
    if (now - lastTouch <= 300) e.preventDefault();
    lastTouch = now;
}, false);
</script>

</head>
<body>

<div id="header">
    <h1>–ö–æ–º–ø–ª–µ–∫—Å —Ä–∞—Å—Ç—è–∂–∫–∏ ‚Äî 8 –º–∏–Ω—É—Ç</h1>
</div>

<div id="center-area">

    <div id="exercise-index">&nbsp;</div>

    <!-- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ -->
    <div id="progress-dots">‚óè ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã</div>

    <div id="exercise">–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª</div>
    <div id="emoji-box">üôÇ</div>

    <div class="timer-circle">
        <svg class="timer-svg" width="200" height="200">
            <circle id="background-ring" cx="100" cy="100" r="90"></circle>
            <circle id="progress-ring" cx="100" cy="100" r="90"></circle>
        </svg>
        <div id="timer">0</div>
    </div>

    <!-- –æ–±—â–∏–π —Ç–∞–π–º–µ—Ä -->
    <div id="total-time">–û–±—â–µ–µ –≤—Ä–µ–º—è: 00:00</div>

    <div id="hint">–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å.</div>

    <button id="restart-btn" class="hidden">–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞</button>

</div>

<div id="controls-wrapper">
    <div class="side-space">
        <button id="prev-btn" class="arrow-btn invisible">‚óÄ</button>
    </div>

    <div id="controls-center">
        <button id="start-btn">–°—Ç–∞—Ä—Ç</button>
        <button id="pause-btn" class="hidden">–ü–∞—É–∑–∞</button>
        <button id="cancel-btn" class="hidden">–û—Ç–º–µ–Ω–∞</button>
    </div>

    <div class="side-space">
        <button id="next-btn" class="arrow-btn invisible">‚ñ∂</button>
    </div>
</div>

<script>
/* –°–ø–∏—Å–æ–∫ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–π */
const exercises = [
    { name: "–ú–æ–±–∏–ª–∏–∑–∞—Ü–∏—è —à–µ–∏", duration: 50, emoji: "üßç‚Äç‚ôÇÔ∏èüß†" },
    { name: "–ö–æ—à–∫–∞‚Äì–∫–æ—Ä–æ–≤–∞", duration: 60, emoji: "üê±üêÑ" },
    { name: "–ù–∏—Ç–µ–≤–∞—è –∏–≥–ª–∞", duration: 60, emoji: "üßµ" },
    { name: "–†–∞—Å—Ç—è–∂–∫–∞ —Ç—Ä–∞–ø–µ—Ü–∏–π", duration: 60, emoji: "üíÜ‚Äç‚ôÇÔ∏è" },
    { name: "–†–∞—Å—Ç—è–∂–∫–∞ –≥—Ä—É–¥–Ω—ã—Ö –º—ã—à—Ü", duration: 60, emoji: "üí™ü´Ä" },
    { name: "–î–µ—Ç—Å–∫–∞—è –ø–æ–∑–∞", duration: 60, emoji: "üßò‚Äç‚ôÇÔ∏è" },
    { name: "–†–∞—Å—Ç—è–∂–∫–∞ –±–æ–∫–æ–≤–æ–π –ª–∏–Ω–∏–∏ —Ç–µ–ª–∞", duration: 60, emoji: "‚ÜîÔ∏èüßç‚Äç‚ôÇÔ∏è" },
    { name: "–õ—ë–≥–∫–∞—è –ª–æ–¥–æ—á–∫–∞", duration: 60, emoji: "üö£‚Äç‚ôÇÔ∏è" }
];

let current = 0;
let timeLeft = 0;
let interval;
let paused = false;

/* –æ–±—â–∏–π —Ç–∞–π–º–µ—Ä */
let totalSeconds = 0;
let totalInterval;

/* —ç–ª–µ–º–µ–Ω—Ç—ã */
const circle       = document.getElementById("progress-ring");
const startBtn     = document.getElementById("start-btn");
const pauseBtn     = document.getElementById("pause-btn");
const cancelBtn    = document.getElementById("cancel-btn");
const prevBtn      = document.getElementById("prev-btn");
const nextBtn      = document.getElementById("next-btn");
const hintEl       = document.getElementById("hint");
const indexEl      = document.getElementById("exercise-index");
const restartBtn   = document.getElementById("restart-btn");
const controlsWrap = document.getElementById("controls-wrapper");
const totalTimeEl  = document.getElementById("total-time");
const dotsEl       = document.getElementById("progress-dots");

const radius = circle.r.baseVal.value;
const circumference = 2 * Math.PI * radius;
circle.style.strokeDasharray = `${circumference} ${circumference}`;
circle.style.strokeDashoffset = circumference;

function setProgress(p) {
    circle.style.strokeDashoffset = circumference - p * circumference;
}

/* —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ */
function formatTime(sec) {
    const m = Math.floor(sec / 60).toString().padStart(2, '0');
    const s = (sec % 60).toString().padStart(2, '0');
    return `${m}:${s}`;
}

/* –∑–∞–ø—É—Å–∫ –æ–±—â–µ–≥–æ —Ç–∞–π–º–µ—Ä–∞ */
function startTotalTimer() {
    totalSeconds = 0;
    totalTimeEl.textContent = "–û–±—â–µ–µ –≤—Ä–µ–º—è: 00:00";

    clearInterval(totalInterval);

    totalInterval = setInterval(() => {
        if (!paused) {
            totalSeconds++;
            totalTimeEl.textContent = "–û–±—â–µ–µ –≤—Ä–µ–º—è: " + formatTime(totalSeconds);
        }
    }, 1000);
}

/* –æ—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±—â–µ–≥–æ —Ç–∞–π–º–µ—Ä–∞ */
function stopTotalTimer() {
    clearInterval(totalInterval);
}

/* –∑–≤—É–∫ */
let audioCtx = null;
function initAudio() {
    if (!audioCtx) {
        const AC = window.AudioContext || window.webkitAudioContext;
        if (AC) audioCtx = new AC();
    }
}

function beep() {
    if (!audioCtx) return;
    const osc = audioCtx.createOscillator();
    const gain = audioCtx.createGain();
    osc.frequency.value = 880;
    gain.gain.setValueAtTime(0.25, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
    osc.connect(gain);
    gain.connect(audioCtx.destination);
    osc.start();
    osc.stop(audioCtx.currentTime + 0.15);
}

/* –≤–∏–±—Ä–∞—Ü–∏—è (—Ä–∞–±–æ—á–∞—è –Ω–∞ iPhone) */
function vibrate() {
    if (navigator.vibrate) {
        navigator.vibrate(120);
        return;
    }

    // fallback —á–µ—Ä–µ–∑ –∞—É–¥–∏–æ-–∏–º–ø—É–ª—å—Å
    if (audioCtx) {
        const osc = audioCtx.createOscillator();
        const gain = audioCtx.createGain();
        osc.frequency.value = 80;
        gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
        gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.1);
        osc.connect(gain);
        gain.connect(audioCtx.destination);
        osc.start();
        osc.stop(audioCtx.currentTime + 0.1);
    }
}

/* –∫–Ω–æ–ø–∫–∏ */
function showInitialControls() {
    startBtn.classList.remove("hidden");
    pauseBtn.classList.add("hidden");
    cancelBtn.classList.add("hidden");
    prevBtn.classList.add("invisible");
    nextBtn.classList.add("invisible");
    restartBtn.classList.add("hidden");
    dotsEl.innerHTML = "‚óè ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã";
    indexEl.innerHTML = "&nbsp;";
    controlsWrap.style.display = "flex";
}

function showRunningControls() {
    startBtn.classList.add("hidden");
    pauseBtn.classList.remove("hidden");
    cancelBtn.classList.remove("hidden");

    if (current === 0) {
        prevBtn.classList.add("invisible");
        nextBtn.classList.remove("invisible");
    } else if (current === exercises.length - 1) {
        prevBtn.classList.remove("invisible");
        nextBtn.classList.add("invisible");
    } else {
        prevBtn.classList.remove("invisible");
        nextBtn.classList.remove("invisible");
    }
}

/* –ø—Ä–æ–≥—Ä–µ—Å—Å-—Ç–æ—á–∫–∏ */
function updateDots() {
    if (current >= exercises.length) {
        dotsEl.innerHTML = "&nbsp;";
        return;
    }

    let out = "";
    for (let i = 0; i < exercises.length; i++) {
        out += (i === current) ? "‚óè " : "‚óã ";
    }
    dotsEl.innerHTML = out.trim();
}

/* –ø–æ—Ä—è–¥–∫–æ–≤—ã–π –Ω–æ–º–µ—Ä */
function updateExerciseIndex() {
    if (current >= exercises.length) {
        indexEl.innerHTML = "&nbsp;";
        return;
    }
    indexEl.textContent = `–£–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ ${current + 1} –∏–∑ ${exercises.length}`;
}

/* —Å—Ç–∞—Ä—Ç */
function startWorkout() {
    initAudio();
    current = 0;
    paused = false;
    hintEl.innerText = "";
    restartBtn.classList.add("hidden");

    startTotalTimer();
    runExercise();
}

/* —Å—Ç–∞—Ä—Ç —Å–Ω–∞—á–∞–ª–∞ */
restartBtn.onclick = () => {
    restartBtn.classList.add("hidden");
    startWorkout();
};

/* –æ—Ç–º–µ–Ω–∞ */
cancelBtn.onclick = () => {
    clearInterval(interval);
    stopTotalTimer();

    paused = false;
    current = 0;
    totalSeconds = 0;
    totalTimeEl.textContent = "–û–±—â–µ–µ –≤—Ä–µ–º—è: 00:00";

    document.getElementById("exercise").innerText = "–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª";
    document.getElementById("emoji-box").innerText = "üôÇ";
    document.getElementById("timer").innerText = "0";
    indexEl.innerHTML = "&nbsp;";
    dotsEl.innerHTML = "‚óè ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã ‚óã";

    hintEl.innerText = "–ù–∞–∂–º–∏ ¬´–°—Ç–∞—Ä—Ç¬ª, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –∫–æ–º–ø–ª–µ–∫—Å.";

    setProgress(0);
    showInitialControls();
};

/* –ø–∞—É–∑–∞ */
pauseBtn.onclick = () => {
    paused = !paused;
    pauseBtn.innerText = paused ? "–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å" : "–ü–∞—É–∑–∞";
};

/* —Å—Ç—Ä–µ–ª–∫–∏ */
prevBtn.onclick = () => {
    clearInterval(interval);
    paused = false;
    current = Math.max(0, current - 1);
    runExercise();
};

nextBtn.onclick = () => {
    clearInterval(interval);
    paused = false;
    current = Math.min(exercises.length - 1, current + 1);
    runExercise();
};

/* –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è */
function runExercise() {
    if (current >= exercises.length) {
        finishWorkout();
        return;
    }

    const ex = exercises[current];
    document.getElementById("exercise").innerText = ex.name;
    document.getElementById("emoji-box").innerText = ex.emoji;

    updateExerciseIndex();
    updateDots();
    showRunningControls();
    beep();
    vibrate();

    timeLeft = ex.duration;
    updateTimer();
    setProgress(0);

    clearInterval(interval);
    interval = setInterval(() => {
        if (!paused) {
            timeLeft--;
            updateTimer();
        }
        if (timeLeft <= 0) {
            clearInterval(interval);
            current++;
            runExercise();
        }
    }, 1000);
}

/* –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ */
function finishWorkout() {
    document.getElementById("exercise").innerText = "–ì–æ—Ç–æ–≤–æ!";
    document.getElementById("emoji-box").innerText = "üôè";
    document.getElementById("timer").innerText = "0";

    indexEl.innerHTML = "&nbsp;";
    dotsEl.innerHTML = "&nbsp;";
    hintEl.innerText = "–ö–æ–º–ø–ª–µ–∫—Å –∑–∞–≤–µ—Ä—à—ë–Ω";

    setProgress(1);

    stopTotalTimer();

    controlsWrap.style.display = "none";
    restartBtn.classList.remove("hidden");
}

/* –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–π–º–µ—Ä–∞ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏—è */
function updateTimer() {
    document.getElementById("timer").innerText = timeLeft;
    const total = exercises[current].duration;
    const percent = 1 - timeLeft / total;
    const clamped = Math.min(Math.max(percent, 0), 1);
    setProgress(clamped);
}

/* —Å—Ç–∞—Ä—Ç–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ */
showInitialControls();

startBtn.onclick = startWorkout;
</script>

</body>
</html>